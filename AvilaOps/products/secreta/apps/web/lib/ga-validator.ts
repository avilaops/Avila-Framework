const FORBIDDEN_KEYS = ["email", "mail", "phone", "telephone", "name", "firstname", "lastname", "cpf", "cnpj"]; export function validateEventParams(params: Record<string, any>): boolean { const keys = Object.keys(params).map(k => k.toLowerCase()); for (const forbidden of FORBIDDEN_KEYS) { if (keys.some(k => k.includes(forbidden))) { console.error(`PII detected in event params: ${forbidden}`); return false; } } return true; }